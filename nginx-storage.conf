worker_processes auto;
events { worker_connections 1024; }

http {
  include /etc/nginx/mime.types;
  
  server {
    listen 80;
    server_name _;
    
    # Serve uploaded files
    location ^~ /uploads/ {
      alias /usr/share/nginx/uploads/;
      
      # CORS for dev
      add_header Access-Control-Allow-Origin "*" always;
      add_header Access-Control-Allow-Methods "GET, OPTIONS" always;
      
      # No cache for dev (always fresh)
      add_header Cache-Control "no-store, no-cache, must-revalidate" always;
      
      try_files $uri =404;
    }
    
    # Serve export files
    location ^~ /exports/donations/ {
      alias /usr/share/nginx/exports/donations/;
      
      # Force download
      add_header Content-Disposition "attachment";
      add_header Cache-Control "no-store, no-cache, must-revalidate" always;
      
      try_files $uri =404;
    }
    
    # Health check
    location /nginx-health {
      return 200 "OK\n";
      add_header Content-Type text/plain;
    }
  }
}